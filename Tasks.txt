Tasks are a fundamental component of Data Vault architecture, it enables reliable and efficient management
of data flows from source systems to the Data Vault.
They play a critical role in maintaining 
data integrity, quality, and availability in a data warehouse environment. 
These tasks are also used for scheduling and setting data movement conditions in HUBS & SAT.



create or replace task database.schema.CUSTOMER_STRM_TSK
	warehouse=%%%%%%%%
	schedule='USING CRON 45 9,14 * * * Europe/Berlin'
	COMMENT='This Task will populate the Customer_HUB and Customer_SAT'
	error_integration=BREEZY_TSK_NOTIFICATIONS
	when SYSTEM$STREAM_HAS_DATA('LandingZone.CUSTOMERS_STRM')
	as INSERT ALL
WHEN (SELECT COUNT(1) FROM CUSTOMERS_HUB TRGT WHERE TRGT.CUSTOMERS_HK = SRC_SHA1_CUSTOMER_ID) = 0
    THEN INTO CUSTOMERS_HUB (CUSTOMERS_HK, CUSTOMERS_ID, SOURCE_SYSTEM, LDTS)
                    VALUES(SRC_SHA1_CUSTOMER_ID, SRC_CUSTOMER_ID, SRC_SOURCE_SYSTEM, SRC_LDTS)

WHEN (SELECT COUNT(1) FROM CUSTOMERS_SAT TRGT WHERE TRGT.CUSTOMER_HK = SRC_SHA1_CUSTOMER_ID AND TRGT.HASH_DIFF = SRC_CUSTOMER_HASH_DIFF) = 0
    THEN INTO CUSTOMERS_SAT (CUSTOMER_HK, LDTS, EMAIL, ACCEPTS_MARKETING, CREATED_AT, UPDATED_AT, FIRST_NAME, LAST_NAME, ORDERS_COUNT, CUSTOMER_STATE, TOTAL_SPENT, LAST_ORDER_ID, NOTE, VERIFIED_EMAIL, MULTIPASS_IDENTIFIER, TAX_EXEMPT, TAGS, LAST_ORDER_NAME, CURRENCY, PHONE, ADDRESSES, ACCEPTS_MARKETING_UPDATED_AT, MARKETING_OPT_IN_LEVEL, TAX_EXEMPTIONS, EMAIL_MARKETING_CONSENT, SMS_MARKETING_CONSENT, ADMIN_GRAPHQL_API_ID, DEFAULT_ADDRESS, HASH_DIFF, SOURCE_SYSTEM)
    
    VALUES (SRC_SHA1_CUSTOMER_ID, SRC_LDTS, SRC_EMAIL, SRC_ACCEPTS_MARKETING, SRC_CREATED_AT, SRC_UPDATED_AT, SRC_FIRST_NAME, SRC_LAST_NAME, SRC_ORDERS_COUNT, SRC_CUSTOMER_STATE, SRC_TOTAL_SPENT, SRC_LAST_ORDER_ID, SRC_NOTE, SRC_VERIFIED_EMAIL, SRC_MULTIPASS_IDENTIFIER, SRC_TAX_EXEMPT, SRC_TAGS, SRC_LAST_ORDER_NAME, SRC_CURRENCY, SRC_PHONE, SRC_ADDRESSES, SRC_ACCEPTS_MARKETING_UPDATED_AT, SRC_MARKETING_OPT_IN_LEVEL, SRC_TAX_EXEMPTIONS, SRC_EMAIL_MARKETING_CONSENT, SRC_SMS_MARKETING_CONSENT, SRC_ADMIN_GRAPHQL_API_ID, SRC_DEFAULT_ADDRESS, SRC_CUSTOMER_HASH_DIFF, SRC_SOURCE_SYSTEM)

SELECT

   SHA1_CUSTOMER_ID     SRC_SHA1_CUSTOMER_ID,
   CUSTOMER_ID          SRC_CUSTOMER_ID,
   LDTS                 SRC_LDTS,
   EMAIL                SRC_EMAIL,
   ACCEPTS_MARKETING    SRC_ACCEPTS_MARKETING,
   CREATED_AT           SRC_CREATED_AT,
   UPDATED_AT           SRC_UPDATED_AT,
   FIRST_NAME           SRC_FIRST_NAME,
   LAST_NAME            SRC_LAST_NAME,
   ORDERS_COUNT         SRC_ORDERS_COUNT,
   CUSTOMER_STATE       SRC_CUSTOMER_STATE,
   TOTAL_SPENT          SRC_TOTAL_SPENT,
   LAST_ORDER_ID        SRC_LAST_ORDER_ID,
   NOTE                 SRC_NOTE,
   VERIFIED_EMAIL       SRC_VERIFIED_EMAIL,
   MULTIPASS_IDENTIFIER SRC_MULTIPASS_IDENTIFIER,
   TAX_EXEMPT            SRC_TAX_EXEMPT,
   TAGS                 SRC_TAGS,
   LAST_ORDER_NAME      SRC_LAST_ORDER_NAME,
   CURRENCY             SRC_CURRENCY,
   PHONE                SRC_PHONE,
   ADDRESSES            SRC_ADDRESSES,
   ACCEPTS_MARKETING_UPDATED_AT     SRC_ACCEPTS_MARKETING_UPDATED_AT,
   MARKETING_OPT_IN_LEVEL           SRC_MARKETING_OPT_IN_LEVEL,
   TAX_EXEMPTIONS                   SRC_TAX_EXEMPTIONS,
   EMAIL_MARKETING_CONSENT          SRC_EMAIL_MARKETING_CONSENT,
   SMS_MARKETING_CONSENT            SRC_SMS_MARKETING_CONSENT,
   ADMIN_GRAPHQL_API_ID             SRC_ADMIN_GRAPHQL_API_ID,
   DEFAULT_ADDRESS                  SRC_DEFAULT_ADDRESS,
   CUSTOMER_HASH_DIFF               SRC_CUSTOMER_HASH_DIFF,
   SOURCE_SYSTEM                    SRC_SOURCE_SYSTEM

   FROM LandingZone.CUSTOMER_STRM_OUTBOUND SRC;

---------------------------------------------------------------------------------------------------------

create or replace task database.schema.ORDERS_STRM_TSK
	warehouse=%%%%%%%%%%%
	schedule='USING CRON 45 9,14 * * * Europe/Berlin'
	COMMENT='This will populate the Orders_HUB, Orders_SAT and CUSTOMER_ORDER_LNK Tables'
	error_integration=BREEZY_TSK_NOTIFICATIONS
	when SYSTEM$STREAM_HAS_DATA('LandingZone.ORDERS_STRM')
	as INSERT ALL
WHEN (SELECT COUNT(1) FROM ORDERS_HUB TRGT WHERE TRGT.ORDERS_HK = SRC_SHA1_ORDER_ID) = 0
THEN INTO ORDERS_HUB (ORDERS_HK, ORDER_ID, SOURCE_SYSTEM, LDTS)
              VALUES (SRC_SHA1_ORDER_ID, SRC_ORDER_ID, SRC_SOURCE_SYSTEM, SRC_LDTS)

WHEN (SELECT COUNT(1) FROM ORDERS_SAT TRGT WHERE TRGT.ORDERS_HK = SRC_SHA1_ORDER_ID AND TRGT.HASH_DIFF = SRC_ORDERS_HASH_DIFF) = 0
THEN INTO ORDERS_SAT (ORDERS_HK, ADMIN_GRAPHQL_API_ID, APP_ID, BROWSER_IP, BUYER_ACCEPTS_MARKETING, CANCEL_REASON, CANCELLED_AT, CART_TOKEN, CHECKOUT_ID, CHECKOUT_TOKEN,                         CLIENT_DETAILS, CLOSED_AT, CONFIRMED, CONTACT_EMAIL, CREATED_AT, CURRENCY, CURRENT_SUBTOTAL_PRICE, CURRENT_SUBTOTAL_PRICE_SET, CURRENT_TOTAL_DISCOUNTS,                       CURRENT_TOTAL_DISCOUNTS_SET, CURRENT_TOTAL_DUTIES_SET, CURRENT_TOTAL_PRICE, CURRENT_TOTAL_PRICE_SET, CURRENT_TOTAL_TAX, CURRENT_TOTAL_TAX_SET,                                CUSTOMER_LOCALE, DEVICE_ID, DISCOUNT_CODES, EMAIL, ESTIMATED_TAXES, FINANCIAL_STATUS, FULFILLMENT_STATUS, GATEWAY, LANDING_SITE, LANDING_SITE_REF,                            LOCATION_ID, NAME, NOTE, NOTE_ATTRIBUTES, NUMBER, ORDER_NUMBER, ORDER_STATUS_URL, ORIGINAL_TOTAL_DUTIES_SET, PAYMENT_GATEWAY_NAMES, PHONE,                                    PRESENTMENT_CURRENCY, PROCESSED_AT, PROCESSING_METHOD, REFERENCE, REFERRING_SITE, SOURCE_IDENTIFIER, SOURCE_NAME, SOURCE_URL, SUBTOTAL_PRICE,                                 SUBTOTAL_PRICE_SET, TAGS, TAX_LINES, TAXES_INCLUDED, TEST, TOKEN, TOTAL_DISCOUNTS, TOTAL_DISCOUNTS_SET, TOTAL_LINE_ITEMS_PRICE,                                               TOTAL_LINE_ITEMS_PRICE_SET, TOTAL_OUTSTANDING, TOTAL_PRICE, TOTAL_PRICE_SET, TOTAL_PRICE_USD, TOTAL_SHIPPING_PRICE_SET, TOTAL_TAX, TOTAL_TAX_SET,                             TOTAL_TIP_RECEIVED, TOTAL_WEIGHT, UPDATED_AT, USER_ID, BILLING_ADDRESS, CUSTOMER, DISCOUNT_APPLICATIONS, FULFILLMENTS, LINE_ITEMS, PAYMENT_TERMS,                             REFUNDS, SHIPPING_ADDRESS, SHIPPING_LINES, PAYMENT_DETAILS, CUSTOMER_ID, SOURCE_SYSTEM, LDTS, HASH_DIFF)

            
           VALUES (SRC_SHA1_ORDER_ID, SRC_ADMIN_GRAPHQL_API_ID, SRC_APP_ID, SRC_BROWSER_IP, SRC_BUYER_ACCEPTS_MARKETING, SRC_CANCEL_REASON, SRC_CANCELLED_AT, SRC_CART_TOKEN,                         SRC_CHECKOUT_ID, SRC_CHECKOUT_TOKEN, SRC_CLIENT_DETAILS, SRC_CLOSED_AT, SRC_CONFIRMED, SRC_CONTACT_EMAIL, SRC_CREATED_AT, SRC_CURRENCY,                                     SRC_CURRENT_SUBTOTAL_PRICE, SRC_CURRENT_SUBTOTAL_PRICE_SET, SRC_CURRENT_TOTAL_DISCOUNTS, SRC_CURRENT_TOTAL_DISCOUNTS_SET, SRC_CURRENT_TOTAL_DUTIES_SET,                         SRC_CURRENT_TOTAL_PRICE, SRC_CURRENT_TOTAL_PRICE_SET, SRC_CURRENT_TOTAL_TAX, SRC_CURRENT_TOTAL_TAX_SET, SRC_CUSTOMER_LOCALE, SRC_DEVICE_ID,                                 SRC_DISCOUNT_CODES, SRC_EMAIL, SRC_ESTIMATED_TAXES, SRC_FINANCIAL_STATUS, SRC_FULFILLMENT_STATUS, SRC_GATEWAY, SRC_LANDING_SITE, SRC_LANDING_SITE_REF,                         SRC_LOCATION_ID, SRC_NAME, SRC_NOTE, SRC_NOTE_ATTRIBUTES, SRC_NUMBER, SRC_ORDER_NUMBER, SRC_ORDER_STATUS_URL, SRC_ORIGINAL_TOTAL_DUTIES_SET,                                 SRC_PAYMENT_GATEWAY_NAMES, SRC_PHONE, SRC_PRESENTMENT_CURRENCY, SRC_PROCESSED_AT, SRC_PROCESSING_METHOD, SRC_REFERENCE, SRC_REFERRING_SITE,                                    SRC_SOURCE_IDENTIFIER, SRC_SOURCE_NAME, SRC_SOURCE_URL, SRC_SUBTOTAL_PRICE, SRC_SUBTOTAL_PRICE_SET, SRC_TAGS, SRC_TAX_LINES, SRC_TAXES_INCLUDED,                             SRC_TEST, SRC_TOKEN, SRC_TOTAL_DISCOUNTS, SRC_TOTAL_DISCOUNTS_SET, SRC_TOTAL_LINE_ITEMS_PRICE, SRC_TOTAL_LINE_ITEMS_PRICE_SET, SRC_TOTAL_OUTSTANDING,                         SRC_TOTAL_PRICE, SRC_TOTAL_PRICE_SET, SRC_TOTAL_PRICE_USD, SRC_TOTAL_SHIPPING_PRICE_SET, SRC_TOTAL_TAX, SRC_TOTAL_TAX_SET, SRC_TOTAL_TIP_RECEIVED,                             SRC_TOTAL_WEIGHT, SRC_UPDATED_AT, SRC_USER_ID, SRC_BILLING_ADDRESS, SRC_CUSTOMER, SRC_DISCOUNT_APPLICATIONS, SRC_FULFILLMENTS, SRC_LINE_ITEMS,                               SRC_PAYMENT_TERMS, SRC_REFUNDS, SRC_SHIPPING_ADDRESS, SRC_SHIPPING_LINES, SRC_PAYMENT_DETAILS, SRC_CUSTOMER_ID, SRC_SOURCE_SYSTEM, SRC_LDTS,                                    SRC_ORDERS_HASH_DIFF)

WHEN (SELECT COUNT(1) FROM CUSTOMERS_ORDERS_LNK TRGT WHERE TRGT.CUST_ORD_LNK_HK = SRC_CUST_ORD_LNK_ID) = 0
THEN INTO CUSTOMERS_ORDERS_LNK (CUST_ORD_LNK_HK, CUSTOMERS_HK, ORDERS_HK, LDTS, SOURCE_SYSTEM)
                        VALUES (SRC_CUST_ORD_LNK_ID, SRC_SHA1_CUSTOMER_ID, SRC_SHA1_ORDER_ID, SRC_LDTS, SRC_SOURCE_SYSTEM)

SELECT
        ORDER_ID                        SRC_ORDER_ID,
        ADMIN_GRAPHQL_API_ID            SRC_ADMIN_GRAPHQL_API_ID,
        APP_ID                          SRC_APP_ID,
        BROWSER_IP                      SRC_BROWSER_IP,
        BUYER_ACCEPTS_MARKETING         SRC_BUYER_ACCEPTS_MARKETING,
        CANCEL_REASON                   SRC_CANCEL_REASON,
        CANCELLED_AT                    SRC_CANCELLED_AT,
        CART_TOKEN                      SRC_CART_TOKEN,
        CHECKOUT_ID                     SRC_CHECKOUT_ID,
        CHECKOUT_TOKEN                  SRC_CHECKOUT_TOKEN,
        CLIENT_DETAILS                  SRC_CLIENT_DETAILS,
        CLOSED_AT                       SRC_CLOSED_AT,
        CONFIRMED                       SRC_CONFIRMED,
        CONTACT_EMAIL                   SRC_CONTACT_EMAIL,
        CREATED_AT                      SRC_CREATED_AT,
        CURRENCY                        SRC_CURRENCY,
        CURRENT_SUBTOTAL_PRICE          SRC_CURRENT_SUBTOTAL_PRICE,
        CURRENT_SUBTOTAL_PRICE_SET      SRC_CURRENT_SUBTOTAL_PRICE_SET,
        CURRENT_TOTAL_DISCOUNTS         SRC_CURRENT_TOTAL_DISCOUNTS,
        CURRENT_TOTAL_DISCOUNTS_SET     SRC_CURRENT_TOTAL_DISCOUNTS_SET,
        CURRENT_TOTAL_DUTIES_SET        SRC_CURRENT_TOTAL_DUTIES_SET,
        CURRENT_TOTAL_PRICE             SRC_CURRENT_TOTAL_PRICE,
        CURRENT_TOTAL_PRICE_SET         SRC_CURRENT_TOTAL_PRICE_SET,
        CURRENT_TOTAL_TAX               SRC_CURRENT_TOTAL_TAX,
        CURRENT_TOTAL_TAX_SET           SRC_CURRENT_TOTAL_TAX_SET,
        CUSTOMER_LOCALE                 SRC_CUSTOMER_LOCALE,
        DEVICE_ID                       SRC_DEVICE_ID,
        DISCOUNT_CODES                  SRC_DISCOUNT_CODES,
        EMAIL                           SRC_EMAIL,
        ESTIMATED_TAXES                 SRC_ESTIMATED_TAXES,
        FINANCIAL_STATUS                SRC_FINANCIAL_STATUS,
        FULFILLMENT_STATUS              SRC_FULFILLMENT_STATUS,
        GATEWAY                         SRC_GATEWAY,
        LANDING_SITE                    SRC_LANDING_SITE,
        LANDING_SITE_REF                SRC_LANDING_SITE_REF,
        LOCATION_ID                     SRC_LOCATION_ID,
        NAME                            SRC_NAME,
        NOTE                            SRC_NOTE,
        NOTE_ATTRIBUTES                 SRC_NOTE_ATTRIBUTES,
        NUMBER                          SRC_NUMBER,
        ORDER_NUMBER                    SRC_ORDER_NUMBER,
        ORDER_STATUS_URL                SRC_ORDER_STATUS_URL,
        ORIGINAL_TOTAL_DUTIES_SET       SRC_ORIGINAL_TOTAL_DUTIES_SET,
        PAYMENT_GATEWAY_NAMES           SRC_PAYMENT_GATEWAY_NAMES,
        PHONE                           SRC_PHONE,
        PRESENTMENT_CURRENCY            SRC_PRESENTMENT_CURRENCY,
        PROCESSED_AT                    SRC_PROCESSED_AT,
        PROCESSING_METHOD               SRC_PROCESSING_METHOD,
        REFERENCE                       SRC_REFERENCE,
        REFERRING_SITE                  SRC_REFERRING_SITE,
        SOURCE_IDENTIFIER               SRC_SOURCE_IDENTIFIER,
        SOURCE_NAME                     SRC_SOURCE_NAME,
        SOURCE_URL                      SRC_SOURCE_URL,
        SUBTOTAL_PRICE                  SRC_SUBTOTAL_PRICE,
        SUBTOTAL_PRICE_SET              SRC_SUBTOTAL_PRICE_SET,
        TAGS                            SRC_TAGS,
        TAX_LINES                       SRC_TAX_LINES,
        TAXES_INCLUDED                  SRC_TAXES_INCLUDED,
        TEST                            SRC_TEST,
        TOKEN                           SRC_TOKEN,
        TOTAL_DISCOUNTS                 SRC_TOTAL_DISCOUNTS,
        TOTAL_DISCOUNTS_SET             SRC_TOTAL_DISCOUNTS_SET,
        TOTAL_LINE_ITEMS_PRICE          SRC_TOTAL_LINE_ITEMS_PRICE,
        TOTAL_LINE_ITEMS_PRICE_SET      SRC_TOTAL_LINE_ITEMS_PRICE_SET,
        TOTAL_OUTSTANDING               SRC_TOTAL_OUTSTANDING,
        TOTAL_PRICE                     SRC_TOTAL_PRICE,
        TOTAL_PRICE_SET                 SRC_TOTAL_PRICE_SET,
        TOTAL_PRICE_USD                 SRC_TOTAL_PRICE_USD,
        TOTAL_SHIPPING_PRICE_SET        SRC_TOTAL_SHIPPING_PRICE_SET,
        TOTAL_TAX                       SRC_TOTAL_TAX,
        TOTAL_TAX_SET                   SRC_TOTAL_TAX_SET,
        TOTAL_TIP_RECEIVED              SRC_TOTAL_TIP_RECEIVED,
        TOTAL_WEIGHT                    SRC_TOTAL_WEIGHT,
        UPDATED_AT                      SRC_UPDATED_AT,
        USER_ID                         SRC_USER_ID,
        BILLING_ADDRESS                 SRC_BILLING_ADDRESS,
        CUSTOMER                        SRC_CUSTOMER,
        DISCOUNT_APPLICATIONS           SRC_DISCOUNT_APPLICATIONS,
        FULFILLMENTS                    SRC_FULFILLMENTS,
        LINE_ITEMS                      SRC_LINE_ITEMS,
        PAYMENT_TERMS                   SRC_PAYMENT_TERMS,
        REFUNDS                         SRC_REFUNDS,
        SHIPPING_ADDRESS                SRC_SHIPPING_ADDRESS,
        SHIPPING_LINES                  SRC_SHIPPING_LINES,
        PAYMENT_DETAILS                 SRC_PAYMENT_DETAILS,
        CUSTOMER_ID                     SRC_CUSTOMER_ID,
        SHA1_ORDER_ID                   SRC_SHA1_ORDER_ID,
        SHA1_CUSTOMER_ID                SRC_SHA1_CUSTOMER_ID,
        SOURCE_SYSTEM                   SRC_SOURCE_SYSTEM,
        LDTS                            SRC_LDTS,
        METADATA$ACTION                 SRC_METADATA$ACTION,
        METADATA$ISUPDATE               SRC_METADATA$ISUPDATE,
        METADATA$ROW_ID                 SRC_METADATA$ROW_ID,
        CUST_ORD_LNK_ID                 SRC_CUST_ORD_LNK_ID,
        ORDERS_HASH_DIFF                SRC_ORDERS_HASH_DIFF

FROM LandingZone.ORDERS_STRM_OUTBOUND SRC;

------------------------------------------------------------------------------------------------------------------------------
create or replace task BREEZY.B_DV_SHOPIFY.PRODUCT_STRM_TSK
	warehouse=%%%%%%%%%
	schedule='USING CRON 45 9,14 * * * Europe/Berlin'
	error_integration=BREEZY_TSK_NOTIFICATIONS
	when SYSTEM$STREAM_HAS_DATA('LandingZone.PRODUCT_STRM')
	as INSERT ALL
WHEN (SELECT COUNT(1) FROM PRODUCTS_HUB TRGT WHERE TRGT.PRODUCTS_HK = SRC_SHA1_PRODUCT_KEY) = 0
    THEN INTO PRODUCTS_HUB (PRODUCTS_HK, PRODUCTS_ID, SOURCE_SYSTEM, LDTS)
                    VALUES(SRC_SHA1_PRODUCT_KEY, SRC_PRODUCT_ID, SRC_SOURCE_SYSTEM, SRC_LDTS)

WHEN (SELECT COUNT(1) FROM PRODUCTS_SAT TRGT WHERE TRGT.PRODUCTS_HK = SRC_SHA1_PRODUCT_KEY AND TRGT.HASH_DIFF = SRC_PRODUCTS_HASH_DIFF) = 0
    THEN INTO PRODUCTS_SAT (PRODUCTS_HK, TITLE, BODY_HTML, VENDOR, PRODUCT_TYPE, CREATED_AT, PRODUCT_HANDLE, UPDATED_AT, PUBLISHED_AT, TEMPLATE_SUFFIX, STATUS,                                           PUBLISHED_SCOPE, TAGS, ADMIN_GRAPHQL_API_ID, VARIANTS, OPTIONS, IMAGES, IMAGE, SOURCE_SYSTEM, LDTS, HASH_DIFF)
    
                    VALUES (SRC_SHA1_PRODUCT_KEY, SRC_TITLE, SRC_BODY_HTML, SRC_VENDOR, SRC_PRODUCT_TYPE, SRC_CREATED_AT, SRC_PRODUCT_HANDLE, SRC_UPDATED_AT,                                             SRC_PUBLISHED_AT, SRC_TEMPLATE_SUFFIX, SRC_STATUS, SRC_PUBLISHED_SCOPE, SRC_TAGS, SRC_ADMIN_GRAPHQL_API_ID, SRC_VARIANTS, SRC_OPTIONS,                                        SRC_IMAGES, SRC_IMAGE, SRC_SOURCE_SYSTEM, SRC_LDTS, SRC_PRODUCTS_HASH_DIFF)

SELECT
    PRODUCT_ID          SRC_PRODUCT_ID,
    TITLE               SRC_TITLE,
    BODY_HTML           SRC_BODY_HTML,
    VENDOR              SRC_VENDOR,
    PRODUCT_TYPE        SRC_PRODUCT_TYPE,
    CREATED_AT          SRC_CREATED_AT,
    PRODUCT_HANDLE      SRC_PRODUCT_HANDLE,
    UPDATED_AT          SRC_UPDATED_AT,
    PUBLISHED_AT         SRC_PUBLISHED_AT,
    TEMPLATE_SUFFIX     SRC_TEMPLATE_SUFFIX,
    STATUS              SRC_STATUS,
    PUBLISHED_SCOPE     SRC_PUBLISHED_SCOPE,
    TAGS                SRC_TAGS,
    ADMIN_GRAPHQL_API_ID     SRC_ADMIN_GRAPHQL_API_ID,
    VARIANTS            SRC_VARIANTS,
    OPTIONS             SRC_OPTIONS,
    IMAGES              SRC_IMAGES,
    IMAGE               SRC_IMAGE,
    SHA1_PRODUCT_KEY    SRC_SHA1_PRODUCT_KEY,
    SOURCE_SYSTEM       SRC_SOURCE_SYSTEM,
    LDTS                SRC_LDTS,
    PRODUCTS_HASH_DIFF  SRC_PRODUCTS_HASH_DIFF

FROM LandingZone.PRODUCT_STRM_OUTBOUND SRC;
------------------------------------------------------------------------------------------------------------------------------------------------------------------